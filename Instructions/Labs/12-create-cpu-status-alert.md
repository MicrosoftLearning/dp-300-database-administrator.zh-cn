---
lab:
  title: 实验室 12 - 为 SQL Server 创建 CPU 状态警报
  module: Automate database tasks for Azure SQL
---

# 在 Azure 上为 SQL Server 创建 CPU 状态警报

预计时间：30 分钟

你已被聘用为高级数据工程师，以帮助自动执行数据库管理的日常操作。 此自动化旨在帮助确保 AdventureWorks 数据库持续以峰值性能运行，并提供基于特定条件发出警报的方法。

## 当 CPU 超过平均值 80% 时，创建警报

1. 在 Azure 门户顶部的搜索栏中，输入 SQL，然后选择“SQL 数据库”。 选择列出的 AdventureWorksLT 数据库名称。

    ![显示选择 SQL 数据库的屏幕截图](../images/dp-300-module-12-lab-01.png)

1. 在 AdventureWorksLT 数据库的主边栏选项卡上，向下导航到监视部分。 选择“**警报**”。

    ![显示在 SQL 数据库概述页面上选择“警报”的屏幕截图](../images/dp-300-module-12-lab-02.png)

1. 选择“创建警报规则”。

    ![显示选择“新建警报规则”的屏幕截图](../images/dp-300-module-12-lab-03.png)

1. 在“选择信号”滑出控件中，选择“CPU 百分比” 。

    ![选择“CPU 百分比”的屏幕截图](../images/dp-300-module-12-lab-04.png)

1. 在“配置信号”滑出对话框中，为“阈值”属性选择“静态”  。 然后，检查是否“运算符”属性为“大于”，“聚合类型”是否为“平均值”   。 然后在“阈值”中输入值 80。 选择“完成”  。

    ![显示输入 80 并选择“完成”的屏幕截图](../images/dp-300-module-12-lab-05.png)

1. 选择“操作”选项卡。

    ![显示选中“选择操作组”链接的屏幕截图](../images/dp-300-module-12-lab-06.png)

1. 在“操作”选项卡下，选择“创建操作组” 。

    ![显示选择“创建操作组”的屏幕截图](../images/dp-300-module-12-lab-07.png)

1. 在“操作组”屏幕上，在“操作组名称”字段中键入“emailgroup”，然后选择“下一步: 通知”   。

    ![显示输入 emailgroup 并选择“下一页: 通知”的屏幕截图](../images/dp-300-module-12-lab-08.png)

1. 在“通知”选项卡上，输入以下信息：

    - 通知类型：电子邮件/短信/推送/语音
        - 注意：选择此选项时，将显示“电子邮件/短信/推送/语音”浮出控件。 检查“电子邮件”属性并键入登录时使用的 Azure 用户名。
    - 名称：DemoLab

    ![“创建操作组”页面的屏幕截图，其中包含添加的信息](../images/dp-300-module-12-lab-09.png)

1. 依次选择“查看 + 创建”、“创建”。

    ![“创建警报规则”页面的屏幕截图，其中选择了“创建警报规则”](../images/dp-300-module-12-lab-10.png)

    注意：在选择“创建”之前，还可以选择“测试操作组(预览版)”来测试警报  。

1. 创建规则后，类似于下面这样的电子邮件会发送到输入的电子邮件地址。

    ![确认电子邮件的屏幕截图](../images/dp-300-module-12-lab-11.png)

    在实施了警报后，如果 CPU 使用率平均值超过 80%，则会发送类似于下面这样的电子邮件。

    ![警报电子邮件的屏幕截图](../images/dp-300-module-12-lab-12.png)

当某些指标（例如数据库大小或 CPU 使用率）达到定义的阈值时，警报可以向你发送电子邮件或调用 Webhook。 你刚刚了解了如何轻松地为 Azure SQL 数据库配置警报。
